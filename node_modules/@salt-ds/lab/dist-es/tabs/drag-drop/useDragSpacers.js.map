{"version":3,"file":"useDragSpacers.js","sources":["../src/tabs/drag-drop/useDragSpacers.ts"],"sourcesContent":["import { useCallback, useMemo, useRef } from \"react\";\nimport { MeasuredDropTarget } from \"./drag-utils\";\nimport { createDragSpacer } from \"./Draggable\";\nimport { Direction } from \"./dragDropTypes\";\n\nexport const useDragSpacers = () => {\n  const animationFrame = useRef(0);\n  const transitioning = useRef(false);\n\n  const spacers = useMemo(\n    // We only need to listen for transition end on one of the spacers\n    () => [createDragSpacer(transitioning), createDragSpacer()],\n    []\n  );\n\n  const clearSpacers = useCallback(\n    () =>\n      spacers.forEach((spacer) => spacer.parentElement?.removeChild(spacer)),\n    []\n  );\n\n  const animateTransition = useCallback((size: number) => {\n    const [spacer1, spacer2] = spacers;\n    animationFrame.current = requestAnimationFrame(() => {\n      transitioning.current = true;\n      spacer1.style.cssText = \"width: 0px\";\n      spacer2.style.cssText = `width: ${size}px`;\n      spacers[0] = spacer2;\n      spacers[1] = spacer1;\n    });\n  }, []);\n\n  const cancelAnyPendingAnimation = useCallback(() => {\n    if (animationFrame.current) {\n      cancelAnimationFrame(animationFrame.current);\n      animationFrame.current = 0;\n    }\n  }, []);\n\n  const displaceItem = useCallback(\n    (\n      item: MeasuredDropTarget | null = null,\n      size: number,\n      useTransition = false,\n      direction?: Direction\n    ) => {\n      if (item) {\n        const [spacer1, spacer2] = spacers;\n        cancelAnyPendingAnimation();\n        if (useTransition) {\n          if (transitioning.current) {\n            clearSpacers();\n\n            spacer1.style.cssText = `width: ${size}px`;\n            spacer2.style.cssText = `width: 0px`;\n\n            const target =\n              direction === \"fwd\"\n                ? item.element.previousElementSibling\n                : item.element.nextElementSibling;\n\n            item.element.parentElement?.insertBefore(spacer1, target);\n            item.element.parentElement?.insertBefore(spacer2, item.element);\n          } else {\n            item.element.parentElement?.insertBefore(spacer2, item.element);\n          }\n          animateTransition(size);\n        } else {\n          spacer1.style.cssText = `width: ${size}px`;\n          item.element.parentElement?.insertBefore(spacer1, item.element);\n        }\n      }\n    },\n    []\n  );\n  const displaceLastItem = useCallback(\n    (item: MeasuredDropTarget, size: number, useTransition = false) => {\n      const [spacer1, spacer2] = spacers;\n      cancelAnyPendingAnimation();\n      if (useTransition) {\n        if (transitioning.current) {\n          clearSpacers();\n\n          spacer1.style.cssText = `width: ${size}px`;\n          spacer2.style.cssText = `width: 0px`;\n\n          item.element.parentElement?.insertBefore(\n            spacer1,\n            item.element.previousElementSibling\n          );\n          item.element.parentElement?.insertBefore(\n            spacer2,\n            item.element.nextElementSibling\n          );\n        } else {\n          item.element.parentElement?.insertBefore(\n            spacer2,\n            item.element.nextElementSibling\n          );\n        }\n        animateTransition(size);\n      } else {\n        spacer1.style.cssText = `width: ${size}px`;\n        item.element.parentElement?.insertBefore(\n          spacer1,\n          item.element.nextElementSibling\n        );\n      }\n    },\n    []\n  );\n\n  return {\n    displaceItem,\n    displaceLastItem,\n    clearSpacers,\n  };\n};\n"],"names":[],"mappings":";;;AAKO,MAAM,iBAAiB,MAAM;AAClC,EAAM,MAAA,cAAA,GAAiB,OAAO,CAAC,CAAA,CAAA;AAC/B,EAAM,MAAA,aAAA,GAAgB,OAAO,KAAK,CAAA,CAAA;AAElC,EAAA,MAAM,OAAU,GAAA,OAAA;AAAA,IAEd,MAAM,CAAC,gBAAA,CAAiB,aAAa,CAAA,EAAG,kBAAkB,CAAA;AAAA,IAC1D,EAAC;AAAA,GACH,CAAA;AAEA,EAAA,MAAM,YAAe,GAAA,WAAA;AAAA,IACnB,MACE,OAAA,CAAQ,OAAQ,CAAA,CAAC,MAAQ,KAAA;AAjB/B,MAAA,IAAA,EAAA,CAAA;AAiBkC,MAAO,OAAA,CAAA,EAAA,GAAA,MAAA,CAAA,aAAA,KAAP,mBAAsB,WAAY,CAAA,MAAA,CAAA,CAAA;AAAA,KAAO,CAAA;AAAA,IACvE,EAAC;AAAA,GACH,CAAA;AAEA,EAAM,MAAA,iBAAA,GAAoB,WAAY,CAAA,CAAC,IAAiB,KAAA;AACtD,IAAM,MAAA,CAAC,OAAS,EAAA,OAAO,CAAI,GAAA,OAAA,CAAA;AAC3B,IAAe,cAAA,CAAA,OAAA,GAAU,sBAAsB,MAAM;AACnD,MAAA,aAAA,CAAc,OAAU,GAAA,IAAA,CAAA;AACxB,MAAA,OAAA,CAAQ,MAAM,OAAU,GAAA,YAAA,CAAA;AACxB,MAAQ,OAAA,CAAA,KAAA,CAAM,UAAU,CAAU,OAAA,EAAA,IAAA,CAAA,EAAA,CAAA,CAAA;AAClC,MAAA,OAAA,CAAQ,CAAK,CAAA,GAAA,OAAA,CAAA;AACb,MAAA,OAAA,CAAQ,CAAK,CAAA,GAAA,OAAA,CAAA;AAAA,KACd,CAAA,CAAA;AAAA,GACH,EAAG,EAAE,CAAA,CAAA;AAEL,EAAM,MAAA,yBAAA,GAA4B,YAAY,MAAM;AAClD,IAAA,IAAI,eAAe,OAAS,EAAA;AAC1B,MAAA,oBAAA,CAAqB,eAAe,OAAO,CAAA,CAAA;AAC3C,MAAA,cAAA,CAAe,OAAU,GAAA,CAAA,CAAA;AAAA,KAC3B;AAAA,GACF,EAAG,EAAE,CAAA,CAAA;AAEL,EAAA,MAAM,YAAe,GAAA,WAAA;AAAA,IACnB,CACE,IAAkC,GAAA,IAAA,EAClC,IACA,EAAA,aAAA,GAAgB,OAChB,SACG,KAAA;AA7CT,MAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA;AA8CM,MAAA,IAAI,IAAM,EAAA;AACR,QAAM,MAAA,CAAC,OAAS,EAAA,OAAO,CAAI,GAAA,OAAA,CAAA;AAC3B,QAA0B,yBAAA,EAAA,CAAA;AAC1B,QAAA,IAAI,aAAe,EAAA;AACjB,UAAA,IAAI,cAAc,OAAS,EAAA;AACzB,YAAa,YAAA,EAAA,CAAA;AAEb,YAAQ,OAAA,CAAA,KAAA,CAAM,UAAU,CAAU,OAAA,EAAA,IAAA,CAAA,EAAA,CAAA,CAAA;AAClC,YAAA,OAAA,CAAQ,MAAM,OAAU,GAAA,CAAA,UAAA,CAAA,CAAA;AAExB,YAAA,MAAM,SACJ,SAAc,KAAA,KAAA,GACV,KAAK,OAAQ,CAAA,sBAAA,GACb,KAAK,OAAQ,CAAA,kBAAA,CAAA;AAEnB,YAAA,CAAA,EAAA,GAAA,IAAA,CAAK,OAAQ,CAAA,aAAA,KAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA,CAAa,OAAS,EAAA,MAAA,CAAA,CAAA;AAClD,YAAA,CAAA,EAAA,GAAA,IAAA,CAAK,OAAQ,CAAA,aAAA,KAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA,CAAa,SAAS,IAAK,CAAA,OAAA,CAAA,CAAA;AAAA,WAClD,MAAA;AACL,YAAA,CAAA,EAAA,GAAA,IAAA,CAAK,OAAQ,CAAA,aAAA,KAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA,CAAa,SAAS,IAAK,CAAA,OAAA,CAAA,CAAA;AAAA,WACzD;AACA,UAAA,iBAAA,CAAkB,IAAI,CAAA,CAAA;AAAA,SACjB,MAAA;AACL,UAAQ,OAAA,CAAA,KAAA,CAAM,UAAU,CAAU,OAAA,EAAA,IAAA,CAAA,EAAA,CAAA,CAAA;AAClC,UAAA,CAAA,EAAA,GAAA,IAAA,CAAK,OAAQ,CAAA,aAAA,KAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA,CAAa,SAAS,IAAK,CAAA,OAAA,CAAA,CAAA;AAAA,SACzD;AAAA,OACF;AAAA,KACF;AAAA,IACA,EAAC;AAAA,GACH,CAAA;AACA,EAAA,MAAM,gBAAmB,GAAA,WAAA;AAAA,IACvB,CAAC,IAAA,EAA0B,IAAc,EAAA,aAAA,GAAgB,KAAU,KAAA;AA5EvE,MAAA,IAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAAA;AA6EM,MAAM,MAAA,CAAC,OAAS,EAAA,OAAO,CAAI,GAAA,OAAA,CAAA;AAC3B,MAA0B,yBAAA,EAAA,CAAA;AAC1B,MAAA,IAAI,aAAe,EAAA;AACjB,QAAA,IAAI,cAAc,OAAS,EAAA;AACzB,UAAa,YAAA,EAAA,CAAA;AAEb,UAAQ,OAAA,CAAA,KAAA,CAAM,UAAU,CAAU,OAAA,EAAA,IAAA,CAAA,EAAA,CAAA,CAAA;AAClC,UAAA,OAAA,CAAQ,MAAM,OAAU,GAAA,CAAA,UAAA,CAAA,CAAA;AAExB,UAAK,CAAA,EAAA,GAAA,IAAA,CAAA,OAAA,CAAQ,kBAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA;AAAA,YAC1B,OAAA;AAAA,YACA,KAAK,OAAQ,CAAA,sBAAA;AAAA,WAAA,CAAA;AAEf,UAAK,CAAA,EAAA,GAAA,IAAA,CAAA,OAAA,CAAQ,kBAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA;AAAA,YAC1B,OAAA;AAAA,YACA,KAAK,OAAQ,CAAA,kBAAA;AAAA,WAAA,CAAA;AAAA,SAEV,MAAA;AACL,UAAK,CAAA,EAAA,GAAA,IAAA,CAAA,OAAA,CAAQ,kBAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA;AAAA,YAC1B,OAAA;AAAA,YACA,KAAK,OAAQ,CAAA,kBAAA;AAAA,WAAA,CAAA;AAAA,SAEjB;AACA,QAAA,iBAAA,CAAkB,IAAI,CAAA,CAAA;AAAA,OACjB,MAAA;AACL,QAAQ,OAAA,CAAA,KAAA,CAAM,UAAU,CAAU,OAAA,EAAA,IAAA,CAAA,EAAA,CAAA,CAAA;AAClC,QAAK,CAAA,EAAA,GAAA,IAAA,CAAA,OAAA,CAAQ,kBAAb,IAA4B,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,YAAA;AAAA,UAC1B,OAAA;AAAA,UACA,KAAK,OAAQ,CAAA,kBAAA;AAAA,SAAA,CAAA;AAAA,OAEjB;AAAA,KACF;AAAA,IACA,EAAC;AAAA,GACH,CAAA;AAEA,EAAO,OAAA;AAAA,IACL,YAAA;AAAA,IACA,gBAAA;AAAA,IACA,YAAA;AAAA,GACF,CAAA;AACF;;;;"}
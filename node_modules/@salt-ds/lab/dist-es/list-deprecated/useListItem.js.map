{"version":3,"file":"useListItem.js","sources":["../src/list-deprecated/useListItem.ts"],"sourcesContent":["import { useEffect, useMemo, useCallback, MouseEvent } from \"react\";\nimport { ListChildComponentProps } from \"react-window\";\n\nimport { ListItemProps } from \"./ListItem\";\nimport { ListItemBaseProps } from \"./ListItemBase\";\n\nimport { useListStateContext } from \"./ListStateContext\";\nimport { useListItemContext } from \"./ListItemContext\";\n\ntype UseItemHookReturnType<Item> = {\n  /**\n   * Item data\n   */\n  item: Item;\n  /**\n   * Utility function for converting item data to a string\n   */\n  itemToString: (item: Item) => string;\n  /**\n   * Properties applied to a basic list item component\n   */\n  itemProps: ListItemBaseProps;\n};\n\nexport interface IndexedListItemProps<Item> extends ListItemProps<Item> {\n  ariaProps?: {\n    role?: string;\n    \"aria-disabled\"?: string;\n    \"aria-checked\"?: string;\n    \"aria-posinset\"?: number;\n    \"aria-setsize\"?: number;\n  };\n\n  index: number;\n  itemHeight?: number | string;\n}\n\nexport function useListItem<Item>(\n  props: IndexedListItemProps<Item>\n): UseItemHookReturnType<Item> {\n  validateProps(props);\n\n  const context = useListItemContext<Item>();\n  const { state, helpers } = useListStateContext();\n  const { setHighlightedIndex, setFocusVisible, handleSelect } = helpers;\n  const {\n    focusVisible,\n    highlightedIndex,\n    selectedItem,\n    isDeselectable,\n    isDisabled,\n    isMultiSelect,\n  } = state;\n  const {\n    index,\n    item,\n    onClick,\n    onMouseDown,\n    onMouseMove,\n    id = context.getItemId(index),\n    itemHeight = context.getItemHeight?.(index),\n    itemToString = context.itemToString,\n    itemTextHighlightPattern = context.itemTextHighlightPattern,\n    // An item can be disabled by\n    // 1. Setting disabled attribute on the item object, or\n    // 2. Passing a disabled prop directly or\n    // 3. Using the disabled state in list context\n    //TODO Not sure where disabled needs to be defined\n    disabled = (item as any).disabled || isDisabled,\n    ariaProps: ariaPropsProp,\n    style: styleProp,\n    ...restProps\n  } = props;\n\n  const style = useMemo(\n    () => ({\n      height: itemHeight,\n      ...styleProp,\n    }),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [itemHeight, JSON.stringify(styleProp)]\n  );\n\n  const highlighted = index === highlightedIndex;\n  const selected = isMultiSelect\n    ? selectedItem.indexOf(item) !== -1\n    : item === selectedItem;\n\n  const handleClick = useCallback(\n    (event: MouseEvent<HTMLDivElement>) => {\n      handleSelect(event, index, item);\n\n      if (onClick) {\n        onClick(event);\n      }\n    },\n    [handleSelect, index, item, onClick]\n  );\n\n  const handleMouseMove = useCallback(\n    (event: MouseEvent<HTMLDivElement>) => {\n      setHighlightedIndex(index);\n      setFocusVisible(false);\n\n      if (onMouseMove) {\n        onMouseMove(event);\n      }\n    },\n    [index, setFocusVisible, setHighlightedIndex, onMouseMove]\n  );\n\n  const handleMouseDown = (\n    event: MouseEvent<HTMLDivElement, globalThis.MouseEvent>\n  ) => {\n    if (context.disableMouseDown) {\n      event.preventDefault();\n    } else if (onMouseDown) {\n      onMouseDown(event);\n    }\n  };\n\n  const eventHandlers = {\n    onClick: handleClick,\n    onMouseMove: handleMouseMove,\n    onMouseDown: handleMouseDown,\n  };\n\n  const ariaProps = {\n    role: \"option\",\n    ...(disabled && { \"aria-disabled\": true }),\n    ...ariaPropsProp,\n  };\n\n  if (selected) {\n    ariaProps[`${isMultiSelect ? \"aria-selected\" : \"aria-checked\"}`] = true;\n  }\n\n  return {\n    item: item!,\n    itemToString,\n    itemProps: {\n      \"data-option-index\": index,\n      id,\n      style,\n      deselectable: isDeselectable || isMultiSelect,\n      disabled,\n      selected,\n      highlighted,\n      itemTextHighlightPattern,\n      focusVisible: focusVisible && highlighted,\n      tooltipText: itemToString(item!),\n      ...ariaProps,\n      ...restProps,\n      ...(disabled ? {} : eventHandlers),\n    },\n  };\n}\n\ntype VirtualizedListItemProps = Pick<\n  ListChildComponentProps,\n  \"index\" | \"style\" | \"data\"\n>;\n\nexport const useVirtualizedListItem = (props: VirtualizedListItemProps) => {\n  const { index, data, style = {} } = props;\n  // Filter out inline width added by `react-window` so that it can only be defined using css.\n  const { width: _unusedWidth, height: itemHeight, ...restStyle } = style;\n\n  return useListItem({\n    index,\n    itemHeight,\n    style: restStyle,\n    item: data[index],\n    ariaProps: {\n      \"aria-posinset\": index + 1,\n      \"aria-setsize\": data.length,\n    },\n  });\n};\n\nconst validateProps = <Item>(props: IndexedListItemProps<Item>) => {\n  const { index, item } = props;\n\n  /* eslint-disable react-hooks/rules-of-hooks */\n  useEffect(() => {\n    if (item === undefined) {\n      console.warn(\"useListItem needs `item`.\");\n    }\n    if (index === undefined) {\n      console.warn(\"useListItem needs to know item's index.\");\n    }\n  }, [index, item]);\n  /* eslint-enable react-hooks/rules-of-hooks */\n};\n"],"names":[],"mappings":"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"}
import { jsx } from 'react/jsx-runtime';
import { createContext, useRef, useState, useContext } from 'react';
import { useIsomorphicLayoutEffect } from '@salt-ds/core';

const DescendantContext = createContext();
function DescendantProvider({ items, ...props }) {
  const assigning = useRef(true);
  const [, forceUpdate] = useState();
  useIsomorphicLayoutEffect(() => {
    if (assigning.current) {
      assigning.current = false;
      forceUpdate({});
    } else {
      assigning.current = true;
    }
    return () => {
      if (assigning.current) {
        items.current = [];
      }
    };
  }, [items]);
  return /* @__PURE__ */ jsx(DescendantContext.Provider, {
    ...props,
    value: { items, assigning }
  });
}
function useDescendant(descendant) {
  const { assigning, items } = useContext(DescendantContext);
  const index = useRef(-1);
  useIsomorphicLayoutEffect(() => {
    if (assigning.current) {
      index.current = items.current.push(descendant) - 1;
    }
  });
  return index.current;
}

export { DescendantContext, DescendantProvider, useDescendant };
//# sourceMappingURL=DescendantContext.js.map

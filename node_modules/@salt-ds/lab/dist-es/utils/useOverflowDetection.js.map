{"version":3,"file":"useOverflowDetection.js","sources":["../src/utils/useOverflowDetection.ts"],"sourcesContent":["import { useState, useRef, Ref, DependencyList, useCallback } from \"react\";\nimport {\n  debounce,\n  ownerWindow,\n  useIsomorphicLayoutEffect,\n} from \"@salt-ds/core\";\n\nexport function useOverflowDetection<Element extends HTMLElement>(\n  dependencies: DependencyList = []\n): [Ref<Element>, boolean] {\n  const targetRef = useRef<Element>(null);\n  const [isOverflowed, setOverflowed] = useState(false);\n\n  const handleResize = useCallback(\n    debounce(() => {\n      const { current } = targetRef;\n\n      if (!current) {\n        // no component to measure yet\n        isOverflowed && setOverflowed(false);\n        return;\n      }\n\n      setOverflowed(current.offsetWidth < current.scrollWidth);\n    }),\n    [targetRef, isOverflowed]\n  );\n\n  // check on resizing\n  useIsomorphicLayoutEffect(() => {\n    // Multi window support\n    const win = ownerWindow(targetRef.current);\n\n    win.addEventListener(\"resize\", handleResize);\n    return () => {\n      handleResize.clear();\n      win.removeEventListener(\"resize\", handleResize);\n    };\n  }, [targetRef, handleResize]);\n\n  // We don't put handleResize in the dependency array as it's been handled by the `useLayoutEffect` above\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  useIsomorphicLayoutEffect(handleResize, dependencies);\n\n  return [targetRef, isOverflowed];\n}\n"],"names":[],"mappings":";;;AAOgB,SAAA,oBAAA,CACd,YAA+B,GAAA,EACN,EAAA;AACzB,EAAM,MAAA,SAAA,GAAY,OAAgB,IAAI,CAAA,CAAA;AACtC,EAAA,MAAM,CAAC,YAAA,EAAc,aAAa,CAAA,GAAI,SAAS,KAAK,CAAA,CAAA;AAEpD,EAAA,MAAM,YAAe,GAAA,WAAA;AAAA,IACnB,SAAS,MAAM;AACb,MAAM,MAAA,EAAE,SAAY,GAAA,SAAA,CAAA;AAEpB,MAAA,IAAI,CAAC,OAAS,EAAA;AAEZ,QAAA,YAAA,IAAgB,cAAc,KAAK,CAAA,CAAA;AACnC,QAAA,OAAA;AAAA,OACF;AAEA,MAAc,aAAA,CAAA,OAAA,CAAQ,WAAc,GAAA,OAAA,CAAQ,WAAW,CAAA,CAAA;AAAA,KACxD,CAAA;AAAA,IACD,CAAC,WAAW,YAAY,CAAA;AAAA,GAC1B,CAAA;AAGA,EAAA,yBAAA,CAA0B,MAAM;AAE9B,IAAM,MAAA,GAAA,GAAM,WAAY,CAAA,SAAA,CAAU,OAAO,CAAA,CAAA;AAEzC,IAAI,GAAA,CAAA,gBAAA,CAAiB,UAAU,YAAY,CAAA,CAAA;AAC3C,IAAA,OAAO,MAAM;AACX,MAAA,YAAA,CAAa,KAAM,EAAA,CAAA;AACnB,MAAI,GAAA,CAAA,mBAAA,CAAoB,UAAU,YAAY,CAAA,CAAA;AAAA,KAChD,CAAA;AAAA,GACC,EAAA,CAAC,SAAW,EAAA,YAAY,CAAC,CAAA,CAAA;AAI5B,EAAA,yBAAA,CAA0B,cAAc,YAAY,CAAA,CAAA;AAEpD,EAAO,OAAA,CAAC,WAAW,YAAY,CAAA,CAAA;AACjC;;;;"}
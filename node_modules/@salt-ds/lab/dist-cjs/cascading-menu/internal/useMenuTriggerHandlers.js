'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var React = require('react');
var useEventCallback = require('../../utils/useEventCallback.js');
require('@salt-ds/core');
var stateChangeTypes = require('../stateChangeTypes.js');
var CascadingMenuAction = require('./CascadingMenuAction.js');

function useMenuTriggerHandlers({
  dispatch,
  children,
  setIsNavigatingWithKeyboard,
  openCloseMenu,
  rootMenuState,
  rootMenuId,
  menusDataById = {}
}) {
  const handleOnClick = useEventCallback.useEventCallback((event) => {
    var _a;
    const { type } = event;
    setIsNavigatingWithKeyboard(false);
    if (type === "click") {
      if (React.isValidElement(children)) {
        const childrenProps = children.props;
        (_a = childrenProps.onClick) == null ? void 0 : _a.call(childrenProps, event);
      }
      openCloseMenu(!rootMenuState);
    }
  });
  const handleOnKeydown = useEventCallback.useEventCallback(
    (event) => {
      var _a;
      const { key } = event;
      switch (key) {
        case "Spacebar":
        case " ":
        case "Enter":
          event.stopPropagation();
          event.preventDefault();
          setIsNavigatingWithKeyboard(true);
          dispatch({
            type: rootMenuState ? CascadingMenuAction.CascadingMenuAction.CLOSE_MENU : CascadingMenuAction.CascadingMenuAction.OPEN_MENU,
            cause: stateChangeTypes.stateChangeTypes.KEYBOARD_TOGGLE,
            targetId: rootMenuId
          });
          break;
        case "ArrowDown":
          event.stopPropagation();
          event.preventDefault();
          setIsNavigatingWithKeyboard(true);
          if (rootMenuState) {
            break;
          }
          dispatch({
            type: CascadingMenuAction.CascadingMenuAction.OPEN_MENU,
            cause: stateChangeTypes.stateChangeTypes.KEYBOARD_TOGGLE,
            targetId: rootMenuId
          });
          break;
        case "ArrowUp":
          event.stopPropagation();
          event.preventDefault();
          setIsNavigatingWithKeyboard(true);
          if (rootMenuState || !rootMenuId) {
            break;
          }
          dispatch({
            type: CascadingMenuAction.CascadingMenuAction.OPEN_MENU,
            cause: stateChangeTypes.stateChangeTypes.KEYBOARD_TOGGLE,
            targetId: rootMenuId
          });
          dispatch({
            type: CascadingMenuAction.CascadingMenuAction.SET_CURRENT_INTERACTED_ITEM,
            cause: stateChangeTypes.stateChangeTypes.ITEM_KEYDOWN_ARROW_UP,
            targetId: rootMenuId,
            highlightedItemIndex: menusDataById[rootMenuId].menuItems.length - 1
          });
          break;
      }
      if (React.isValidElement(children)) {
        const childrenProps = children.props;
        (_a = childrenProps.onKeyDown) == null ? void 0 : _a.call(childrenProps, event);
      }
    }
  );
  return [handleOnClick, handleOnKeydown];
}

exports.useMenuTriggerHandlers = useMenuTriggerHandlers;
//# sourceMappingURL=useMenuTriggerHandlers.js.map

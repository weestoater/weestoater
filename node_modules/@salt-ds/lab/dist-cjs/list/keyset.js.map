{"version":3,"file":"keyset.js","sources":["../src/list/keyset.ts"],"sourcesContent":["export class KeySet {\n  private keys: Map<number, number>;\n\n  private free: number[];\n\n  private nextKeyValue: number;\n\n  constructor(from = 0, to = 0) {\n    this.keys = new Map<number, number>();\n    this.free = [];\n    this.nextKeyValue = 0;\n    this.reset(from, to);\n  }\n\n  next(): number {\n    if (this.free.length) {\n      return this.free.pop()!;\n    } else {\n      return this.nextKeyValue++;\n    }\n  }\n\n  reset(from: number, to: number) {\n    this.keys.forEach((keyValue, rowIndex) => {\n      if (rowIndex < from || rowIndex >= to) {\n        this.free.push(keyValue);\n        this.keys.delete(rowIndex);\n      }\n    });\n\n    const size = to - from;\n    if (this.keys.size + this.free.length > size) {\n      this.free.length = size - this.keys.size;\n    }\n\n    for (let rowIndex = from; rowIndex < to; rowIndex++) {\n      if (!this.keys.has(rowIndex)) {\n        const nextKeyValue = this.next();\n        this.keys.set(rowIndex, nextKeyValue);\n      }\n    }\n  }\n\n  keyFor(rowIndex: number) {\n    return this.keys.get(rowIndex);\n  }\n}\n"],"names":[],"mappings":";;;;AAAO,MAAM,MAAO,CAAA;AAAA,EAOlB,WAAY,CAAA,IAAA,GAAO,CAAG,EAAA,EAAA,GAAK,CAAG,EAAA;AAC5B,IAAK,IAAA,CAAA,IAAA,uBAAW,GAAoB,EAAA,CAAA;AACpC,IAAA,IAAA,CAAK,OAAO,EAAC,CAAA;AACb,IAAA,IAAA,CAAK,YAAe,GAAA,CAAA,CAAA;AACpB,IAAK,IAAA,CAAA,KAAA,CAAM,MAAM,EAAE,CAAA,CAAA;AAAA,GACrB;AAAA,EAEA,IAAe,GAAA;AACb,IAAI,IAAA,IAAA,CAAK,KAAK,MAAQ,EAAA;AACpB,MAAO,OAAA,IAAA,CAAK,KAAK,GAAI,EAAA,CAAA;AAAA,KAChB,MAAA;AACL,MAAA,OAAO,IAAK,CAAA,YAAA,EAAA,CAAA;AAAA,KACd;AAAA,GACF;AAAA,EAEA,KAAA,CAAM,MAAc,EAAY,EAAA;AAC9B,IAAA,IAAA,CAAK,IAAK,CAAA,OAAA,CAAQ,CAAC,QAAA,EAAU,QAAa,KAAA;AACxC,MAAI,IAAA,QAAA,GAAW,IAAQ,IAAA,QAAA,IAAY,EAAI,EAAA;AACrC,QAAK,IAAA,CAAA,IAAA,CAAK,KAAK,QAAQ,CAAA,CAAA;AACvB,QAAK,IAAA,CAAA,IAAA,CAAK,OAAO,QAAQ,CAAA,CAAA;AAAA,OAC3B;AAAA,KACD,CAAA,CAAA;AAED,IAAA,MAAM,OAAO,EAAK,GAAA,IAAA,CAAA;AAClB,IAAA,IAAI,KAAK,IAAK,CAAA,IAAA,GAAO,IAAK,CAAA,IAAA,CAAK,SAAS,IAAM,EAAA;AAC5C,MAAA,IAAA,CAAK,IAAK,CAAA,MAAA,GAAS,IAAO,GAAA,IAAA,CAAK,IAAK,CAAA,IAAA,CAAA;AAAA,KACtC;AAEA,IAAA,KAAA,IAAS,QAAW,GAAA,IAAA,EAAM,QAAW,GAAA,EAAA,EAAI,QAAY,EAAA,EAAA;AACnD,MAAA,IAAI,CAAC,IAAA,CAAK,IAAK,CAAA,GAAA,CAAI,QAAQ,CAAG,EAAA;AAC5B,QAAM,MAAA,YAAA,GAAe,KAAK,IAAK,EAAA,CAAA;AAC/B,QAAK,IAAA,CAAA,IAAA,CAAK,GAAI,CAAA,QAAA,EAAU,YAAY,CAAA,CAAA;AAAA,OACtC;AAAA,KACF;AAAA,GACF;AAAA,EAEA,OAAO,QAAkB,EAAA;AACvB,IAAO,OAAA,IAAA,CAAK,IAAK,CAAA,GAAA,CAAI,QAAQ,CAAA,CAAA;AAAA,GAC/B;AACF;;;;"}